"use strict";
var server_api_1 = require('../server-api/server-api');
var _ = require('lodash');
function makeInstanceOf(dotEnsime, connection, ui) {
    function destroy() {
        connection.destroy();
        if (ui) {
            ui.destroy();
        }
    }
    var isSourceOf = function (path) { return _.some(dotEnsime.sourceRoots, function (sourceRoot) { return _.startsWith(path, sourceRoot); }); };
    return {
        httpPort: connection.httpPort,
        rootDir: dotEnsime.rootDir,
        api: server_api_1.apiOf(connection),
        destroy: destroy,
        isSourceOf: isSourceOf,
        dotEnsime: dotEnsime,
        ui: ui
    };
}
exports.makeInstanceOf = makeInstanceOf;

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxpYi9pbnN0YW5jZS9pbnN0YW5jZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBRUEsMkJBQXlCLDBCQUN6QixDQUFDLENBRGtEO0FBQ25ELElBQVksQ0FBQyxXQUFNLFFBQ25CLENBQUMsQ0FEMEI7QUFnQjNCLHdCQUE0RCxTQUFvQixFQUFFLFVBQTRCLEVBQUUsRUFBSztJQUNqSDtRQUNJLFVBQVUsQ0FBQyxPQUFPLEVBQUUsQ0FBQTtRQUNwQixFQUFFLENBQUEsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO1lBQ0osRUFBRSxDQUFDLE9BQU8sRUFBRSxDQUFBO1FBQ2hCLENBQUM7SUFDTCxDQUFDO0lBRUQsSUFBTSxVQUFVLEdBQUcsVUFBQyxJQUFZLElBQUssT0FBQSxDQUFDLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxXQUFXLEVBQUUsVUFBQyxVQUFVLElBQUssT0FBQSxDQUFDLENBQUMsVUFBVSxDQUFDLElBQUksRUFBRSxVQUFVLENBQUMsRUFBOUIsQ0FBOEIsQ0FBQyxFQUE3RSxDQUE2RSxDQUFBO0lBRWxILE1BQU0sQ0FBQztRQUNILFFBQVEsRUFBRSxVQUFVLENBQUMsUUFBUTtRQUM3QixPQUFPLEVBQUUsU0FBUyxDQUFDLE9BQU87UUFDMUIsR0FBRyxFQUFFLGtCQUFLLENBQUMsVUFBVSxDQUFDO1FBQ3RCLFNBQUEsT0FBTztRQUNQLFlBQUEsVUFBVTtRQUNWLFdBQUEsU0FBUztRQUNULElBQUEsRUFBRTtLQUNMLENBQUE7QUFFTCxDQUFDO0FBcEJlLHNCQUFjLGlCQW9CN0IsQ0FBQSIsImZpbGUiOiJsaWIvaW5zdGFuY2UvaW5zdGFuY2UuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge0RvdEVuc2ltZX0gZnJvbSAnLi4vdHlwZXMnXG5pbXBvcnQge1NlcnZlckNvbm5lY3Rpb259IGZyb20gJy4uL3NlcnZlci1hcGkvc2VydmVyLWNvbm5lY3Rpb24nXG5pbXBvcnQge0FwaSwgYXBpT2Z9IGZyb20gJy4uL3NlcnZlci1hcGkvc2VydmVyLWFwaSdcbmltcG9ydCAqIGFzIF8gZnJvbSAnbG9kYXNoJ1xuaW1wb3J0ICogYXMgcGF0aCBmcm9tICdwYXRoJ1xuXG5cbmV4cG9ydCBpbnRlcmZhY2UgRW5zaW1lSW5zdGFuY2U8VUk+IHtcbiAgICBkZXN0cm95KCkgOiBhbnk7XG4gICAgcm9vdERpcjogc3RyaW5nO1xuICAgIGh0dHBQb3J0OiBzdHJpbmc7XG4gICAgYXBpOiBBcGk7XG4gICAgZG90RW5zaW1lOiBEb3RFbnNpbWU7XG4gICAgaXNTb3VyY2VPZihwYXRoOiBzdHJpbmcpOiBib29sZWFuO1xuICAgIFxuICAgIC8qKiBDbGllbnQgc3BlY2lmaWMgdWkgdG8gdXNlIGZvciB1aSBzd2l0Y2hpbmcgYW5kIHN0dWZmICovXG4gICAgdWk6IFVJXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBtYWtlSW5zdGFuY2VPZjxUIGV4dGVuZHMge2Rlc3Ryb3koKTogdm9pZH0+KGRvdEVuc2ltZTogRG90RW5zaW1lLCBjb25uZWN0aW9uOiBTZXJ2ZXJDb25uZWN0aW9uLCB1aTogVCkgOiBFbnNpbWVJbnN0YW5jZTxUPntcbiAgICBmdW5jdGlvbiBkZXN0cm95ICgpIHtcbiAgICAgICAgY29ubmVjdGlvbi5kZXN0cm95KClcbiAgICAgICAgaWYodWkpIHtcbiAgICAgICAgICAgIHVpLmRlc3Ryb3koKVxuICAgICAgICB9IFxuICAgIH0gXG4gICAgXG4gICAgY29uc3QgaXNTb3VyY2VPZiA9IChwYXRoOiBzdHJpbmcpID0+IF8uc29tZShkb3RFbnNpbWUuc291cmNlUm9vdHMsIChzb3VyY2VSb290KSA9PiBfLnN0YXJ0c1dpdGgocGF0aCwgc291cmNlUm9vdCkpICAgIFxuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgaHR0cFBvcnQ6IGNvbm5lY3Rpb24uaHR0cFBvcnQsXG4gICAgICAgIHJvb3REaXI6IGRvdEVuc2ltZS5yb290RGlyLFxuICAgICAgICBhcGk6IGFwaU9mKGNvbm5lY3Rpb24pLFxuICAgICAgICBkZXN0cm95LFxuICAgICAgICBpc1NvdXJjZU9mLFxuICAgICAgICBkb3RFbnNpbWUsXG4gICAgICAgIHVpXG4gICAgfSBcbiAgICAgICAgXG59Il19
